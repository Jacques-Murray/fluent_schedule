name: Publish to crates.io

on:
  # Triggers the workflow only when you create a new release on GitHub
  release:
    types: [published] # Runs only when you click "Publish release"

jobs:
  publish:
    name: Build and Publish
    runs-on: ubuntu-latest

    steps:
      # 1. Get the repository code
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2. Install the Rust toolchain
      - name: Install Rust
        uses: dtolnay/rust-toolchain@stable

      # 3. Publish to crates.io
      # This step uses the secret token you added to GitHub
      - name: Publish to crates.io
        run: cargo publish
        env:
          CARGO_REGISTRY_TOKEN: ${{ secrets.CARGO_REGISTRY_TOKEN }}
